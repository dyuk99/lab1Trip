<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="../css/libs.min.css">
  <link rel="stylesheet" href="https://unpkg.com/vue-form-wizard/dist/vue-form-wizard.min.css">
  <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="../css/form.css">

</head>
<body>
<div class="container-fluid">
   <div class="row justify-content-center">
   <div class="col-md-10">
   <div class="row">
     <div class="col-md-12 form-div">
       <h1 class="text-center">Add new city</h1>
       <hr>
	   <div id="app">
			<div>
        		<form-wizard  
        		      color="#483D8B" 
        		      error-color="#a94442"
        			  title=""
                      subtitle=""
                      @on-complete="onComplete">
            		<tab-content title="Name"
                        icon="ti-pencil-alt" :before-change="validateFirstTab">
              			<vue-form-generator :model="model" 
                                   :schema="firstTabSchema"
                                   :options="formOptions"
                                   ref="firstTabForm">           
               			</vue-form-generator>
            		</tab-content>
            		<tab-content title="Description"
                        icon="ti-align-center" :before-change="validateSecondTab">
              			<vue-form-generator :model="model" 
                                   :schema="secondTabSchema"
                                   :options="formOptions"
                                   ref="secondTabForm">                                
               			</vue-form-generator>
            		</tab-content>
            		<tab-content title="Image"
                        icon="ti-image" :before-change="validateThirdTab">
              			<vue-form-generator :model="model" 
                                   :schema="thirdTabSchema"
                                   :options="formOptions"	
                                   ref="thirdTabForm">                                
               			</vue-form-generator>
               			<img class="uploadedImg img-thumbnail" v-bind:class="{ 'uploadedImg_active': model.image }" v-bind:src="model.image">
            		</tab-content>
        		</form-wizard>
 			</div>
		</div>
     </div>
     </div>
     </div>
   </div>
 </div>
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
<script src="../js/libs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.2.6/vue.min.js"></script>
<script src="https://unpkg.com/vue-form-wizard/dist/vue-form-wizard.js"></script>
<script src="https://rawgit.com/icebob/vue-form-generator/master/dist/vfg.js"></script>
<script type="text/javascript">
Vue.use(VueFormWizard)
Vue.use(VueFormGenerator)

new Vue({
 el: '#app',
 data:{
   model:{
    city: '',
    description: '',
    image: ''
   },
   formOptions: {
    validationErrorClass: "has-error",
    validationSuccessClass: "has-success",
    validateAfterChanged: true,
    validateAfterLoad: false
   },
   firstTabSchema:{
     fields:[
      {
        type: "input",
        inputType: "text",
        label: "Name of the city",
        model: "city",
        required:true,
        validator:VueFormGenerator.validators.string,
        styleClasses:'col-xs-12'
     }
     ]
   },
   secondTabSchema:{
     fields:[
      {
        type: "textArea",
        label: "Description of the city",
        model: "description",
        required:true,
        max: 400,
        min: 10,
        hint: "Min 100 and max 400 characters",
        validator:VueFormGenerator.validators.string,
        styleClasses:'col-xs-12'
     }
     ]
   },
   thirdTabSchema:{
     fields:[
      {
	    type: "image",
	    label: "Image of the city",
	    model: "image",
	    required: true,
	    hideInput:true,
	    styleClasses:'col-xs-12',
	    pattern: '/[\s\S]*/',
	    validator:VueFormGenerator.validators.regexp
	}
     ]
   }
 },
 methods: {
  onComplete: () => {
      swal({
		  title: 'Are you sure?',
		  text: "You won't be able to revert this!",
		  type: 'warning',
		  showCancelButton: true,
		  confirmButtonColor: '#3085d6',
		  cancelButtonColor: '#d33',
		  confirmButtonText: 'Yes, create it!'
	})
    .then(() => {
    return $.ajax({
       url: "/",
       type: "POST",
       data: model
    });
	})
   },
   validateFirstTab: function(){
     return this.$refs.firstTabForm.validate();
   },
   validateSecondTab: function(){
     return this.$refs.secondTabForm.validate();
   },
   validateThirdTab: function(){
     return this.$refs.thirdTabForm.validate();
   }
}
})
</script>
</body>
</html>